{"ast":null,"code":"import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeStyle as _normalizeStyle, createElementVNode as _createElementVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-0e2bdf73\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"cloud-bed\"\n};\nconst _hoisted_2 = {\n  class: \"cloud-box\"\n};\nconst _hoisted_3 = [\"onClick\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"section\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.dataList, (item, index) => {\n    return _openBlock(), _createElementBlock(\"span\", {\n      key: index,\n      onClick: $event => $options.getDataInfo(item),\n      style: _normalizeStyle({\n        color: item.color,\n        background: item.bgColor\n      })\n    }, _toDisplayString(item.name), 13 /* TEXT, STYLE, PROPS */, _hoisted_3);\n  }), 128 /* KEYED_FRAGMENT */))])]);\n}","map":{"version":3,"mappings":";;;EACWA,KAAK,EAAC;AAAW;;EACnBA,KAAK,EAAC;AAAW;;;uBADxBC,oBAWU,WAXVC,UAWU,GAVRC,oBASM,OATNC,UASM,sBARJH,oBAOOI,6BANqBC,cAAQ,GAAxBC,IAAI,EAAEC,KAAK;yBADvBP,oBAOO;MALFQ,GAAG,EAAED,KAAK;MACVE,OAAK,YAAEC,oBAAW,CAACJ,IAAI;MACvBK,KAAK;QAAAC,OAASN,IAAI,CAACM,KAAK;QAAAC,YAAYP,IAAI,CAACQ;MAAO;wBAEhDR,IAAI,CAACS,IAAI","names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_Fragment","$data","item","index","key","onClick","$options","style","color","background","bgColor","name"],"sourceRoot":"","sources":["/Users/tangxinyu/WebstormProjects/cs209a_proj/src/components/WordCloudGraph.vue"],"sourcesContent":["<template>\n  <section class=\"cloud-bed\">\n    <div class=\"cloud-box\">\n      <span\n          v-for=\"(item, index) in dataList\"\n          :key=\"index\"\n          @click=\"getDataInfo(item)\"\n          :style=\"{color:item.color,background:item.bgColor}\"\n      >\n        {{ item.name }}\n      </span>\n    </div>\n  </section>\n</template>\n\n<script>\nexport default {\n  name: \"word-cloud\",\n  data() {\n    return {\n      timer: 50, // 球体转动速率\n      radius: 0, // 词云球体面积大小\n      dtr: Math.PI/180, //鼠标滑过球体转动速度\n      active: false, // 默认加载是否开启转动\n      lasta: 0, // 上下转动\n      lastb: 0.5, // 左右转动\n      distr: true,\n      tspeed: 0, // 鼠标移动上去时球体转动\n      mouseX: 0,\n      mouseY: 0,\n      tagAttrList: [],\n      tagContent: null,\n      cloudContent: null,\n      sinA: '',\n      cosA: '',\n      sinB: '',\n      cosB: '',\n      sinC: '',\n      cosC: '',\n      dataList: [\n        {\n          name: '页面卡顿白屏',\n          value: '1',\n          bgColor:'rgb(57, 193, 207,0.12)',\n          color:'#39c1cf',\n        },\n        {\n          name: '闪退',\n          value: '8',\n          bgColor:'rgb(66, 105, 245,0.12)',\n          color:'#4269f5',\n        },\n        {\n          name: '登录问题',\n          value: '9',\n          bgColor:'rgb(184, 107, 215,0.12)',\n          color:'#b86bd7',\n        },\n        {\n          name: '功能bug',\n          value: '3',\n          bgColor:'rgb(243, 84, 83,0.12)',\n          color:'#f35453',\n        },\n        {\n          name: '无法收到短信',\n          value: '6',\n          bgColor:'rgb(250, 116, 20,0.12)',\n          color:'#FA7414',\n        },\n        {\n          name: '人脸/指纹认证失败',\n          value: '10',\n          bgColor:'rgb(255, 171, 30,0.12)',\n          color:'#FFAB1E',\n        },\n        {\n          name: '功能建议',\n          value: '2',\n          bgColor:'rgb(136, 104, 217,0.12)',\n          color:'#8868D9',\n        },\n        {\n          name: 'UI/UX',\n          value: '5',\n          bgColor:'rgb(42, 184, 230,0.12)',\n          color:'#2AB8E6',\n        },\n        {\n          name: '导航性',\n          value: '7',\n          bgColor:'rgb(117, 133, 162,0.12)',\n          color:'#7585A2',\n        },\n      ]\n    }\n  },\n  mounted () {\n    this.$nextTick(() => {\n      this.radius = document.querySelector('.cloud-box').offsetWidth / 2\n      this.initWordCloud()\n    })\n  },\n  // beforeDestroy () {\n  //   clearInterval(this.timer)\n  // },\n  methods:{\n    // 获取点击文本信息\n    getDataInfo (item) {\n      console.log(item, 'item')\n    },\n    initWordCloud () {\n      this.cloudContent = document.querySelector('.cloud-box');\n      this.tagContent = this.cloudContent.getElementsByTagName('span');\n      for (let i = 0; i < this.tagContent.length; i++) {\n        let tagObj = {};\n        tagObj.offsetWidth = this.tagContent[i].offsetWidth;\n        tagObj.offsetHeight = this.tagContent[i].offsetHeight;\n        this.tagAttrList.push(tagObj);\n      }\n      this.sineCosine(0, 0, 0);\n      this.positionAll();\n      this.cloudContent.onmouseover = () => {\n        this.active=true;\n      };\n      this.cloudContent.onmouseout = () => {\n        this.active=false;\n      };\n      this.cloudContent.onmousemove = (ev) => {\n        let oEvent = window.event || ev;\n        this.mouseX = oEvent.clientX - (this.cloudContent.offsetLeft + this.cloudContent.offsetWidth/2);\n        this.mouseY = oEvent.clientY - (this.cloudContent.offsetTop + this.cloudContent.offsetHeight/2);\n        this.mouseX/= 5;\n        this.mouseY/= 5;\n      };\n      setInterval(this.update, this.timer);\n    },\n    positionAll () {\n      let phi = 0;\n      let theta = 0;\n      let max = this.tagAttrList.length;\n      let aTmp = [];\n      let oFragment = document.createDocumentFragment();\n      //随机排序\n      for (let i=0; i < this.tagContent.length; i++) {\n        aTmp.push(this.tagContent[i]);\n      }\n      aTmp.sort(() => {\n        return Math.random() < 0.5 ? 1 : -1;\n      });\n      for (let i = 0; i < aTmp.length; i++) {\n        oFragment.appendChild(aTmp[i]);\n      }\n      this.cloudContent.appendChild(oFragment);\n      for(let i = 1; i < max + 1; i++){\n        if (this.distr) {\n          phi = Math.acos(-1 + (2 * i - 1) / max);\n          theta = Math.sqrt(max * Math.PI) * phi;\n        } else {\n          phi = Math.random() * (Math.PI);\n          theta = Math.random() * (2 * Math.PI);\n        }\n        //坐标变换\n        this.tagAttrList[i-1].cx = this.radius * Math.cos(theta) * Math.sin(phi);\n        this.tagAttrList[i-1].cy = this.radius * Math.sin(theta) * Math.sin(phi);\n        this.tagAttrList[i-1].cz = this.radius * Math.cos(phi);\n        this.tagContent[i-1].style.left = this.tagAttrList[i-1].cx + this.cloudContent.offsetWidth / 2 - this.tagAttrList[i-1].offsetWidth / 2 + 'px';\n        this.tagContent[i-1].style.top = this.tagAttrList[i-1].cy + this.cloudContent.offsetHeight / 2 - this.tagAttrList[i-1].offsetHeight / 2 + 'px';\n      }\n    },\n    update () {\n      let angleBasicA;\n      let angleBasicB;\n\n      if (this.active) {\n        angleBasicA = (-Math.min(Math.max(-this.mouseY, -200 ), 200) / this.radius) * this.tspeed;\n        angleBasicB = (Math.min(Math.max(-this.mouseX, -200 ), 200) / this.radius) * this.tspeed;\n      } else {\n        angleBasicA = this.lasta * 0.98;\n        angleBasicB = this.lastb * 0.98;\n      }\n\n      //默认转动是后是否需要停下\n      // lasta=a;\n      // lastb=b;\n\n      // if(Math.abs(a)<=0.01 && Math.abs(b)<=0.01)\n      // {\n      // return;\n      // }\n      this.sineCosine(angleBasicA, angleBasicB, 0);\n      for(let j = 0; j < this.tagAttrList.length; j++) {\n        let rx1 = this.tagAttrList[j].cx;\n        let ry1 = this.tagAttrList[j].cy * this.cosA + this.tagAttrList[j].cz * (-this.sinA);\n        let rz1 = this.tagAttrList[j].cy * this.sinA + this.tagAttrList[j].cz * this.cosA;\n\n        let rx2 = rx1 * this.cosB + rz1 * this.sinB;\n        let ry2 = ry1;\n        let rz2 = rx1 * (-this.sinB) + rz1 * this.cosB;\n\n        let rx3 = rx2 * this.cosC + ry2 * (-this.sinC);\n        let ry3 = rx2 * this.sinC + ry2 * this.cosC;\n        let rz3 = rz2;\n        this.tagAttrList[j].cx = rx3;\n        this.tagAttrList[j].cy = ry3;\n        this.tagAttrList[j].cz = rz3;\n\n        let per = 350 / (350 + rz3);\n\n        this.tagAttrList[j].x = rx3 * per - 2;\n        this.tagAttrList[j].y = ry3 * per;\n        this.tagAttrList[j].scale = per;\n        this.tagAttrList[j].alpha = per;\n\n        this.tagAttrList[j].alpha = (this.tagAttrList[j].alpha - 0.6) * (10/6);\n      }\n      this.doPosition();\n      this.depthSort();\n    },\n    doPosition() {\n      let len = this.cloudContent.offsetWidth/2;\n      let height = this.cloudContent.offsetHeight/2;\n      for (let i=0;i < this.tagAttrList.length;i++) {\n        this.tagContent[i].style.left = this.tagAttrList[i].cx + len - this.tagAttrList[i].offsetWidth/2 + 'px';\n        this.tagContent[i].style.top = this.tagAttrList[i].cy + height - this.tagAttrList[i].offsetHeight/2 + 'px';\n        // this.tagContent[i].style.fontSize = Math.ceil(12 * this.tagAttrList[i].scale/2) + 8 + 'px';\n        this.tagContent[i].style.fontSize = Math.ceil(12 * this.tagAttrList[i].scale/2) +2 + 'px';\n        this.tagContent[i].style.filter = \"alpha(opacity=\"+100 * this.tagAttrList[i].alpha+\")\";\n        this.tagContent[i].style.opacity = this.tagAttrList[i].alpha;\n      }\n    },\n    depthSort(){\n      let aTmp = [];\n      for (let i = 0; i < this.tagContent.length; i++) {\n        aTmp.push(this.tagContent[i]);\n      }\n      aTmp.sort((item1, item2) => item2.cz - item1.cz);\n      for (let i = 0; i < aTmp.length; i++) {\n        aTmp[i].style.zIndex=i;\n      }\n    },\n    sineCosine (a, b, c) {\n      this.sinA = Math.sin(a * this.dtr);\n      this.cosA = Math.cos(a * this.dtr);\n      this.sinB = Math.sin(b * this.dtr);\n      this.cosB = Math.cos(b * this.dtr);\n      this.sinC = Math.sin(c * this.dtr);\n      this.cosC = Math.cos(c * this.dtr);\n    }\n  }\n};\n</script>\n\n\n<style scoped>\n.cloud-bed {\n  width: 200px;\n  height: 200px;\n  margin: auto;\n}\n.cloud-box{\n  position:relative;\n  margin:20px auto 0px;\n  width: 100%;\n  height: 100%;\n  background:\t#00000000;\n}\n.cloud-box span{\n  position: absolute;\n  padding: 3px 6px;\n  top: 0px;\n  font-weight: bold;\n  text-decoration:none;\n  left:0px;\n  background-image: linear-gradient(to bottom, red, #fff);\n  /*background-clip: text;*/\n  color: transparent;\n  width: 50px;\n  height: 50px;\n  border-radius: 50%;\n  text-align: center;\n\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  /* line-height: 50px;\n  overflow:hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis; */\n}\n</style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}