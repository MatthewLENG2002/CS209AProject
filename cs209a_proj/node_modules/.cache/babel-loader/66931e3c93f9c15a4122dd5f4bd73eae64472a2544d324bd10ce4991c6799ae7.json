{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { mapGetters } from \"vuex\";\nexport default {\n  name: \"word-cloud\",\n  computed: {\n    ...mapGetters([\"getIssueKeyword\"])\n  },\n  data() {\n    return {\n      timer: 50,\n      // 球体转动速率\n      radius: 0,\n      // 词云球体面积大小\n      dtr: Math.PI / 180,\n      //鼠标滑过球体转动速度\n      active: false,\n      // 默认加载是否开启转动\n      lasta: 0,\n      // 上下转动\n      lastb: 0.5,\n      // 左右转动\n      distr: true,\n      tspeed: 0,\n      // 鼠标移动上去时球体转动\n      mouseX: 0,\n      mouseY: 0,\n      tagAttrList: [],\n      tagContent: null,\n      cloudContent: null,\n      sinA: '',\n      cosA: '',\n      sinB: '',\n      cosB: '',\n      sinC: '',\n      cosC: '',\n      dataList: [{\n        name: this.getIssueKeyword[0],\n        value: '1',\n        bgColor: 'rgb(57, 193, 207,0.12)',\n        color: '#39c1cf'\n      }, {\n        name: '闪退',\n        value: '8',\n        bgColor: 'rgb(66, 105, 245,0.12)',\n        color: '#4269f5'\n      }, {\n        name: '登录问题',\n        value: '9',\n        bgColor: 'rgb(184, 107, 215,0.12)',\n        color: '#b86bd7'\n      }, {\n        name: '功能bug',\n        value: '3',\n        bgColor: 'rgb(243, 84, 83,0.12)',\n        color: '#f35453'\n      }, {\n        name: '无法收到短信',\n        value: '6',\n        bgColor: 'rgb(250, 116, 20,0.12)',\n        color: '#FA7414'\n      }, {\n        name: '人脸/指纹认证失败',\n        value: '10',\n        bgColor: 'rgb(255, 171, 30,0.12)',\n        color: '#FFAB1E'\n      }, {\n        name: '功能建议',\n        value: '2',\n        bgColor: 'rgb(136, 104, 217,0.12)',\n        color: '#8868D9'\n      }, {\n        name: 'UI/UX',\n        value: '5',\n        bgColor: 'rgb(42, 184, 230,0.12)',\n        color: '#2AB8E6'\n      }, {\n        name: '导航性',\n        value: '7',\n        bgColor: 'rgb(117, 133, 162,0.12)',\n        color: '#7585A2'\n      }]\n    };\n  },\n  mounted() {\n    this.$nextTick(() => {\n      this.radius = document.querySelector('.cloud-box').offsetWidth / 2;\n      this.initWordCloud();\n    });\n  },\n  beforeDestroy() {\n    clearInterval(this.timer);\n  },\n  methods: {\n    // 获取点击文本信息\n    getDataInfo(item) {\n      console.log(item, 'item');\n    },\n    initWordCloud() {\n      this.cloudContent = document.querySelector('.cloud-box');\n      this.tagContent = this.cloudContent.getElementsByTagName('span');\n      for (let i = 0; i < this.tagContent.length; i++) {\n        let tagObj = {};\n        tagObj.offsetWidth = this.tagContent[i].offsetWidth;\n        tagObj.offsetHeight = this.tagContent[i].offsetHeight;\n        this.tagAttrList.push(tagObj);\n      }\n      this.sineCosine(0, 0, 0);\n      this.positionAll();\n      this.cloudContent.onmouseover = () => {\n        this.active = true;\n      };\n      this.cloudContent.onmouseout = () => {\n        this.active = false;\n      };\n      this.cloudContent.onmousemove = ev => {\n        let oEvent = window.event || ev;\n        this.mouseX = oEvent.clientX - (this.cloudContent.offsetLeft + this.cloudContent.offsetWidth / 2);\n        this.mouseY = oEvent.clientY - (this.cloudContent.offsetTop + this.cloudContent.offsetHeight / 2);\n        this.mouseX /= 5;\n        this.mouseY /= 5;\n      };\n      setInterval(this.update, this.timer);\n    },\n    positionAll() {\n      let phi = 0;\n      let theta = 0;\n      let max = this.tagAttrList.length;\n      let aTmp = [];\n      let oFragment = document.createDocumentFragment();\n      //随机排序\n      for (let i = 0; i < this.tagContent.length; i++) {\n        aTmp.push(this.tagContent[i]);\n      }\n      aTmp.sort(() => {\n        return Math.random() < 0.5 ? 1 : -1;\n      });\n      for (let i = 0; i < aTmp.length; i++) {\n        oFragment.appendChild(aTmp[i]);\n      }\n      this.cloudContent.appendChild(oFragment);\n      for (let i = 1; i < max + 1; i++) {\n        if (this.distr) {\n          phi = Math.acos(-1 + (2 * i - 1) / max);\n          theta = Math.sqrt(max * Math.PI) * phi;\n        } else {\n          phi = Math.random() * Math.PI;\n          theta = Math.random() * (2 * Math.PI);\n        }\n        //坐标变换\n        this.tagAttrList[i - 1].cx = this.radius * Math.cos(theta) * Math.sin(phi);\n        this.tagAttrList[i - 1].cy = this.radius * Math.sin(theta) * Math.sin(phi);\n        this.tagAttrList[i - 1].cz = this.radius * Math.cos(phi);\n        this.tagContent[i - 1].style.left = this.tagAttrList[i - 1].cx + this.cloudContent.offsetWidth / 2 - this.tagAttrList[i - 1].offsetWidth / 2 + 'px';\n        this.tagContent[i - 1].style.top = this.tagAttrList[i - 1].cy + this.cloudContent.offsetHeight / 2 - this.tagAttrList[i - 1].offsetHeight / 2 + 'px';\n      }\n    },\n    update() {\n      let angleBasicA;\n      let angleBasicB;\n      if (this.active) {\n        angleBasicA = -Math.min(Math.max(-this.mouseY, -200), 200) / this.radius * this.tspeed;\n        angleBasicB = Math.min(Math.max(-this.mouseX, -200), 200) / this.radius * this.tspeed;\n      } else {\n        angleBasicA = this.lasta * 0.98;\n        angleBasicB = this.lastb * 0.98;\n      }\n\n      //默认转动是后是否需要停下\n      // lasta=a;\n      // lastb=b;\n\n      // if(Math.abs(a)<=0.01 && Math.abs(b)<=0.01)\n      // {\n      // return;\n      // }\n      this.sineCosine(angleBasicA, angleBasicB, 0);\n      for (let j = 0; j < this.tagAttrList.length; j++) {\n        let rx1 = this.tagAttrList[j].cx;\n        let ry1 = this.tagAttrList[j].cy * this.cosA + this.tagAttrList[j].cz * -this.sinA;\n        let rz1 = this.tagAttrList[j].cy * this.sinA + this.tagAttrList[j].cz * this.cosA;\n        let rx2 = rx1 * this.cosB + rz1 * this.sinB;\n        let ry2 = ry1;\n        let rz2 = rx1 * -this.sinB + rz1 * this.cosB;\n        let rx3 = rx2 * this.cosC + ry2 * -this.sinC;\n        let ry3 = rx2 * this.sinC + ry2 * this.cosC;\n        let rz3 = rz2;\n        this.tagAttrList[j].cx = rx3;\n        this.tagAttrList[j].cy = ry3;\n        this.tagAttrList[j].cz = rz3;\n        let per = 350 / (350 + rz3);\n        this.tagAttrList[j].x = rx3 * per - 2;\n        this.tagAttrList[j].y = ry3 * per;\n        this.tagAttrList[j].scale = per;\n        this.tagAttrList[j].alpha = per;\n        this.tagAttrList[j].alpha = (this.tagAttrList[j].alpha - 0.6) * (10 / 6);\n      }\n      this.doPosition();\n      this.depthSort();\n    },\n    doPosition() {\n      let len = this.cloudContent.offsetWidth / 2;\n      let height = this.cloudContent.offsetHeight / 2;\n      for (let i = 0; i < this.tagAttrList.length; i++) {\n        this.tagContent[i].style.left = this.tagAttrList[i].cx + len - this.tagAttrList[i].offsetWidth / 2 + 'px';\n        this.tagContent[i].style.top = this.tagAttrList[i].cy + height - this.tagAttrList[i].offsetHeight / 2 + 'px';\n        // this.tagContent[i].style.fontSize = Math.ceil(12 * this.tagAttrList[i].scale/2) + 8 + 'px';\n        this.tagContent[i].style.fontSize = Math.ceil(12 * this.tagAttrList[i].scale / 2) + 2 + 'px';\n        this.tagContent[i].style.filter = \"alpha(opacity=\" + 100 * this.tagAttrList[i].alpha + \")\";\n        this.tagContent[i].style.opacity = this.tagAttrList[i].alpha;\n      }\n    },\n    depthSort() {\n      let aTmp = [];\n      for (let i = 0; i < this.tagContent.length; i++) {\n        aTmp.push(this.tagContent[i]);\n      }\n      aTmp.sort((item1, item2) => item2.cz - item1.cz);\n      for (let i = 0; i < aTmp.length; i++) {\n        aTmp[i].style.zIndex = i;\n      }\n    },\n    sineCosine(a, b, c) {\n      this.sinA = Math.sin(a * this.dtr);\n      this.cosA = Math.cos(a * this.dtr);\n      this.sinB = Math.sin(b * this.dtr);\n      this.cosB = Math.cos(b * this.dtr);\n      this.sinC = Math.sin(c * this.dtr);\n      this.cosC = Math.cos(c * this.dtr);\n    }\n  }\n};","map":{"version":3,"mappings":";AAgBA,SAAQA,UAAU,QAAO,MAAM;AAC/B,eAAe;EACbC,IAAI,EAAE,YAAY;EAClBC,QAAQ,EAAC;IACP,GAAGF,UAAU,CAAC,CAAC,iBAAiB,CAAC;EACnC,CAAC;EACDG,IAAI,GAAG;IACL,OAAO;MACLC,KAAK,EAAE,EAAE;MAAE;MACXC,MAAM,EAAE,CAAC;MAAE;MACXC,GAAG,EAAEC,IAAI,CAACC,EAAE,GAAC,GAAG;MAAE;MAClBC,MAAM,EAAE,KAAK;MAAE;MACfC,KAAK,EAAE,CAAC;MAAE;MACVC,KAAK,EAAE,GAAG;MAAE;MACZC,KAAK,EAAE,IAAI;MACXC,MAAM,EAAE,CAAC;MAAE;MACXC,MAAM,EAAE,CAAC;MACTC,MAAM,EAAE,CAAC;MACTC,WAAW,EAAE,EAAE;MACfC,UAAU,EAAE,IAAI;MAChBC,YAAY,EAAE,IAAI;MAClBC,IAAI,EAAE,EAAE;MACRC,IAAI,EAAE,EAAE;MACRC,IAAI,EAAE,EAAE;MACRC,IAAI,EAAE,EAAE;MACRC,IAAI,EAAE,EAAE;MACRC,IAAI,EAAE,EAAE;MACRC,QAAQ,EAAE,CACR;QACExB,IAAI,EAAE,IAAI,CAACyB,eAAe,CAAC,CAAC,CAAC;QAC7BC,KAAK,EAAE,GAAG;QACVC,OAAO,EAAC,wBAAwB;QAChCC,KAAK,EAAC;MACR,CAAC,EACD;QACE5B,IAAI,EAAE,IAAI;QACV0B,KAAK,EAAE,GAAG;QACVC,OAAO,EAAC,wBAAwB;QAChCC,KAAK,EAAC;MACR,CAAC,EACD;QACE5B,IAAI,EAAE,MAAM;QACZ0B,KAAK,EAAE,GAAG;QACVC,OAAO,EAAC,yBAAyB;QACjCC,KAAK,EAAC;MACR,CAAC,EACD;QACE5B,IAAI,EAAE,OAAO;QACb0B,KAAK,EAAE,GAAG;QACVC,OAAO,EAAC,uBAAuB;QAC/BC,KAAK,EAAC;MACR,CAAC,EACD;QACE5B,IAAI,EAAE,QAAQ;QACd0B,KAAK,EAAE,GAAG;QACVC,OAAO,EAAC,wBAAwB;QAChCC,KAAK,EAAC;MACR,CAAC,EACD;QACE5B,IAAI,EAAE,WAAW;QACjB0B,KAAK,EAAE,IAAI;QACXC,OAAO,EAAC,wBAAwB;QAChCC,KAAK,EAAC;MACR,CAAC,EACD;QACE5B,IAAI,EAAE,MAAM;QACZ0B,KAAK,EAAE,GAAG;QACVC,OAAO,EAAC,yBAAyB;QACjCC,KAAK,EAAC;MACR,CAAC,EACD;QACE5B,IAAI,EAAE,OAAO;QACb0B,KAAK,EAAE,GAAG;QACVC,OAAO,EAAC,wBAAwB;QAChCC,KAAK,EAAC;MACR,CAAC,EACD;QACE5B,IAAI,EAAE,KAAK;QACX0B,KAAK,EAAE,GAAG;QACVC,OAAO,EAAC,yBAAyB;QACjCC,KAAK,EAAC;MACR,CAAC;IAEL;EACF,CAAC;EACDC,OAAM,GAAK;IACT,IAAI,CAACC,SAAS,CAAC,MAAM;MACnB,IAAI,CAAC1B,MAAK,GAAI2B,QAAQ,CAACC,aAAa,CAAC,YAAY,CAAC,CAACC,WAAU,GAAI;MACjE,IAAI,CAACC,aAAa,EAAC;IACrB,CAAC;EACH,CAAC;EACDC,aAAY,GAAK;IACfC,aAAa,CAAC,IAAI,CAACjC,KAAK;EAC1B,CAAC;EACDkC,OAAO,EAAC;IACN;IACAC,WAAU,CAAGC,IAAI,EAAE;MACjBC,OAAO,CAACC,GAAG,CAACF,IAAI,EAAE,MAAM;IAC1B,CAAC;IACDL,aAAY,GAAK;MACf,IAAI,CAACjB,YAAW,GAAIc,QAAQ,CAACC,aAAa,CAAC,YAAY,CAAC;MACxD,IAAI,CAAChB,UAAS,GAAI,IAAI,CAACC,YAAY,CAACyB,oBAAoB,CAAC,MAAM,CAAC;MAChE,KAAK,IAAIC,IAAI,CAAC,EAAEA,IAAI,IAAI,CAAC3B,UAAU,CAAC4B,MAAM,EAAED,CAAC,EAAE,EAAE;QAC/C,IAAIE,MAAK,GAAI,CAAC,CAAC;QACfA,MAAM,CAACZ,WAAU,GAAI,IAAI,CAACjB,UAAU,CAAC2B,CAAC,CAAC,CAACV,WAAW;QACnDY,MAAM,CAACC,YAAW,GAAI,IAAI,CAAC9B,UAAU,CAAC2B,CAAC,CAAC,CAACG,YAAY;QACrD,IAAI,CAAC/B,WAAW,CAACgC,IAAI,CAACF,MAAM,CAAC;MAC/B;MACA,IAAI,CAACG,UAAU,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;MACxB,IAAI,CAACC,WAAW,EAAE;MAClB,IAAI,CAAChC,YAAY,CAACiC,WAAU,GAAI,MAAM;QACpC,IAAI,CAAC1C,MAAM,GAAC,IAAI;MAClB,CAAC;MACD,IAAI,CAACS,YAAY,CAACkC,UAAS,GAAI,MAAM;QACnC,IAAI,CAAC3C,MAAM,GAAC,KAAK;MACnB,CAAC;MACD,IAAI,CAACS,YAAY,CAACmC,WAAU,GAAKC,EAAE,IAAK;QACtC,IAAIC,MAAK,GAAIC,MAAM,CAACC,KAAI,IAAKH,EAAE;QAC/B,IAAI,CAACxC,MAAK,GAAIyC,MAAM,CAACG,OAAM,IAAK,IAAI,CAACxC,YAAY,CAACyC,UAAS,GAAI,IAAI,CAACzC,YAAY,CAACgB,WAAW,GAAC,CAAC,CAAC;QAC/F,IAAI,CAACnB,MAAK,GAAIwC,MAAM,CAACK,OAAM,IAAK,IAAI,CAAC1C,YAAY,CAAC2C,SAAQ,GAAI,IAAI,CAAC3C,YAAY,CAAC6B,YAAY,GAAC,CAAC,CAAC;QAC/F,IAAI,CAACjC,MAAM,IAAG,CAAC;QACf,IAAI,CAACC,MAAM,IAAG,CAAC;MACjB,CAAC;MACD+C,WAAW,CAAC,IAAI,CAACC,MAAM,EAAE,IAAI,CAAC3D,KAAK,CAAC;IACtC,CAAC;IACD8C,WAAU,GAAK;MACb,IAAIc,GAAE,GAAI,CAAC;MACX,IAAIC,KAAI,GAAI,CAAC;MACb,IAAIC,GAAE,GAAI,IAAI,CAAClD,WAAW,CAAC6B,MAAM;MACjC,IAAIsB,IAAG,GAAI,EAAE;MACb,IAAIC,SAAQ,GAAIpC,QAAQ,CAACqC,sBAAsB,EAAE;MACjD;MACA,KAAK,IAAIzB,CAAC,GAAC,CAAC,EAAEA,IAAI,IAAI,CAAC3B,UAAU,CAAC4B,MAAM,EAAED,CAAC,EAAE,EAAE;QAC7CuB,IAAI,CAACnB,IAAI,CAAC,IAAI,CAAC/B,UAAU,CAAC2B,CAAC,CAAC,CAAC;MAC/B;MACAuB,IAAI,CAACG,IAAI,CAAC,MAAM;QACd,OAAO/D,IAAI,CAACgE,MAAM,EAAC,GAAI,GAAE,GAAI,IAAI,CAAC,CAAC;MACrC,CAAC,CAAC;MACF,KAAK,IAAI3B,IAAI,CAAC,EAAEA,IAAIuB,IAAI,CAACtB,MAAM,EAAED,CAAC,EAAE,EAAE;QACpCwB,SAAS,CAACI,WAAW,CAACL,IAAI,CAACvB,CAAC,CAAC,CAAC;MAChC;MACA,IAAI,CAAC1B,YAAY,CAACsD,WAAW,CAACJ,SAAS,CAAC;MACxC,KAAI,IAAIxB,IAAI,CAAC,EAAEA,IAAIsB,GAAE,GAAI,CAAC,EAAEtB,CAAC,EAAE,EAAC;QAC9B,IAAI,IAAI,CAAChC,KAAK,EAAE;UACdoD,GAAE,GAAIzD,IAAI,CAACkE,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI7B,IAAI,CAAC,IAAIsB,GAAG,CAAC;UACvCD,KAAI,GAAI1D,IAAI,CAACmE,IAAI,CAACR,GAAE,GAAI3D,IAAI,CAACC,EAAE,IAAIwD,GAAG;QACxC,OAAO;UACLA,GAAE,GAAIzD,IAAI,CAACgE,MAAM,EAAC,GAAKhE,IAAI,CAACC,EAAG;UAC/ByD,KAAI,GAAI1D,IAAI,CAACgE,MAAM,EAAC,IAAK,IAAIhE,IAAI,CAACC,EAAE,CAAC;QACvC;QACA;QACA,IAAI,CAACQ,WAAW,CAAC4B,CAAC,GAAC,CAAC,CAAC,CAAC+B,EAAC,GAAI,IAAI,CAACtE,MAAK,GAAIE,IAAI,CAACqE,GAAG,CAACX,KAAK,IAAI1D,IAAI,CAACsE,GAAG,CAACb,GAAG,CAAC;QACxE,IAAI,CAAChD,WAAW,CAAC4B,CAAC,GAAC,CAAC,CAAC,CAACkC,EAAC,GAAI,IAAI,CAACzE,MAAK,GAAIE,IAAI,CAACsE,GAAG,CAACZ,KAAK,IAAI1D,IAAI,CAACsE,GAAG,CAACb,GAAG,CAAC;QACxE,IAAI,CAAChD,WAAW,CAAC4B,CAAC,GAAC,CAAC,CAAC,CAACmC,EAAC,GAAI,IAAI,CAAC1E,MAAK,GAAIE,IAAI,CAACqE,GAAG,CAACZ,GAAG,CAAC;QACtD,IAAI,CAAC/C,UAAU,CAAC2B,CAAC,GAAC,CAAC,CAAC,CAACoC,KAAK,CAACC,IAAG,GAAI,IAAI,CAACjE,WAAW,CAAC4B,CAAC,GAAC,CAAC,CAAC,CAAC+B,EAAC,GAAI,IAAI,CAACzD,YAAY,CAACgB,WAAU,GAAI,IAAI,IAAI,CAAClB,WAAW,CAAC4B,CAAC,GAAC,CAAC,CAAC,CAACV,WAAU,GAAI,IAAI,IAAI;QAC7I,IAAI,CAACjB,UAAU,CAAC2B,CAAC,GAAC,CAAC,CAAC,CAACoC,KAAK,CAACE,GAAE,GAAI,IAAI,CAAClE,WAAW,CAAC4B,CAAC,GAAC,CAAC,CAAC,CAACkC,EAAC,GAAI,IAAI,CAAC5D,YAAY,CAAC6B,YAAW,GAAI,IAAI,IAAI,CAAC/B,WAAW,CAAC4B,CAAC,GAAC,CAAC,CAAC,CAACG,YAAW,GAAI,IAAI,IAAI;MAChJ;IACF,CAAC;IACDgB,MAAK,GAAK;MACR,IAAIoB,WAAW;MACf,IAAIC,WAAW;MAEf,IAAI,IAAI,CAAC3E,MAAM,EAAE;QACf0E,WAAU,GAAK,CAAC5E,IAAI,CAAC8E,GAAG,CAAC9E,IAAI,CAAC2D,GAAG,CAAC,CAAC,IAAI,CAACnD,MAAM,EAAE,CAAC,GAAE,CAAG,EAAE,GAAG,IAAI,IAAI,CAACV,MAAM,GAAI,IAAI,CAACQ,MAAM;QACzFuE,WAAU,GAAK7E,IAAI,CAAC8E,GAAG,CAAC9E,IAAI,CAAC2D,GAAG,CAAC,CAAC,IAAI,CAACpD,MAAM,EAAE,CAAC,GAAE,CAAG,EAAE,GAAG,IAAI,IAAI,CAACT,MAAM,GAAI,IAAI,CAACQ,MAAM;MAC1F,OAAO;QACLsE,WAAU,GAAI,IAAI,CAACzE,KAAI,GAAI,IAAI;QAC/B0E,WAAU,GAAI,IAAI,CAACzE,KAAI,GAAI,IAAI;MACjC;;MAEA;MACA;MACA;;MAEA;MACA;MACA;MACA;MACA,IAAI,CAACsC,UAAU,CAACkC,WAAW,EAAEC,WAAW,EAAE,CAAC,CAAC;MAC5C,KAAI,IAAIE,IAAI,CAAC,EAAEA,IAAI,IAAI,CAACtE,WAAW,CAAC6B,MAAM,EAAEyC,CAAC,EAAE,EAAE;QAC/C,IAAIC,GAAE,GAAI,IAAI,CAACvE,WAAW,CAACsE,CAAC,CAAC,CAACX,EAAE;QAChC,IAAIa,GAAE,GAAI,IAAI,CAACxE,WAAW,CAACsE,CAAC,CAAC,CAACR,EAAC,GAAI,IAAI,CAAC1D,IAAG,GAAI,IAAI,CAACJ,WAAW,CAACsE,CAAC,CAAC,CAACP,EAAC,GAAK,CAAC,IAAI,CAAC5D,IAAK;QACpF,IAAIsE,GAAE,GAAI,IAAI,CAACzE,WAAW,CAACsE,CAAC,CAAC,CAACR,EAAC,GAAI,IAAI,CAAC3D,IAAG,GAAI,IAAI,CAACH,WAAW,CAACsE,CAAC,CAAC,CAACP,EAAC,GAAI,IAAI,CAAC3D,IAAI;QAEjF,IAAIsE,GAAE,GAAIH,GAAE,GAAI,IAAI,CAACjE,IAAG,GAAImE,GAAE,GAAI,IAAI,CAACpE,IAAI;QAC3C,IAAIsE,GAAE,GAAIH,GAAG;QACb,IAAII,GAAE,GAAIL,GAAE,GAAK,CAAC,IAAI,CAAClE,IAAI,GAAIoE,GAAE,GAAI,IAAI,CAACnE,IAAI;QAE9C,IAAIuE,GAAE,GAAIH,GAAE,GAAI,IAAI,CAAClE,IAAG,GAAImE,GAAE,GAAK,CAAC,IAAI,CAACpE,IAAK;QAC9C,IAAIuE,GAAE,GAAIJ,GAAE,GAAI,IAAI,CAACnE,IAAG,GAAIoE,GAAE,GAAI,IAAI,CAACnE,IAAI;QAC3C,IAAIuE,GAAE,GAAIH,GAAG;QACb,IAAI,CAAC5E,WAAW,CAACsE,CAAC,CAAC,CAACX,EAAC,GAAIkB,GAAG;QAC5B,IAAI,CAAC7E,WAAW,CAACsE,CAAC,CAAC,CAACR,EAAC,GAAIgB,GAAG;QAC5B,IAAI,CAAC9E,WAAW,CAACsE,CAAC,CAAC,CAACP,EAAC,GAAIgB,GAAG;QAE5B,IAAIC,GAAE,GAAI,GAAE,IAAK,GAAE,GAAID,GAAG,CAAC;QAE3B,IAAI,CAAC/E,WAAW,CAACsE,CAAC,CAAC,CAACW,IAAIJ,GAAE,GAAIG,GAAE,GAAI,CAAC;QACrC,IAAI,CAAChF,WAAW,CAACsE,CAAC,CAAC,CAACY,IAAIJ,GAAE,GAAIE,GAAG;QACjC,IAAI,CAAChF,WAAW,CAACsE,CAAC,CAAC,CAACa,KAAI,GAAIH,GAAG;QAC/B,IAAI,CAAChF,WAAW,CAACsE,CAAC,CAAC,CAACc,KAAI,GAAIJ,GAAG;QAE/B,IAAI,CAAChF,WAAW,CAACsE,CAAC,CAAC,CAACc,KAAI,GAAI,CAAC,IAAI,CAACpF,WAAW,CAACsE,CAAC,CAAC,CAACc,KAAI,GAAI,GAAG,KAAK,EAAE,GAAC,CAAC,CAAC;MACxE;MACA,IAAI,CAACC,UAAU,EAAE;MACjB,IAAI,CAACC,SAAS,EAAE;IAClB,CAAC;IACDD,UAAU,GAAG;MACX,IAAIE,GAAE,GAAI,IAAI,CAACrF,YAAY,CAACgB,WAAW,GAAC,CAAC;MACzC,IAAIsE,MAAK,GAAI,IAAI,CAACtF,YAAY,CAAC6B,YAAY,GAAC,CAAC;MAC7C,KAAK,IAAIH,CAAC,GAAC,CAAC,EAACA,IAAI,IAAI,CAAC5B,WAAW,CAAC6B,MAAM,EAACD,CAAC,EAAE,EAAE;QAC5C,IAAI,CAAC3B,UAAU,CAAC2B,CAAC,CAAC,CAACoC,KAAK,CAACC,IAAG,GAAI,IAAI,CAACjE,WAAW,CAAC4B,CAAC,CAAC,CAAC+B,EAAC,GAAI4B,GAAE,GAAI,IAAI,CAACvF,WAAW,CAAC4B,CAAC,CAAC,CAACV,WAAW,GAAC,IAAI,IAAI;QACvG,IAAI,CAACjB,UAAU,CAAC2B,CAAC,CAAC,CAACoC,KAAK,CAACE,GAAE,GAAI,IAAI,CAAClE,WAAW,CAAC4B,CAAC,CAAC,CAACkC,EAAC,GAAI0B,MAAK,GAAI,IAAI,CAACxF,WAAW,CAAC4B,CAAC,CAAC,CAACG,YAAY,GAAC,IAAI,IAAI;QAC1G;QACA,IAAI,CAAC9B,UAAU,CAAC2B,CAAC,CAAC,CAACoC,KAAK,CAACyB,QAAO,GAAIlG,IAAI,CAACmG,IAAI,CAAC,EAAC,GAAI,IAAI,CAAC1F,WAAW,CAAC4B,CAAC,CAAC,CAACuD,KAAK,GAAC,CAAC,IAAG,IAAI,IAAI;QACzF,IAAI,CAAClF,UAAU,CAAC2B,CAAC,CAAC,CAACoC,KAAK,CAAC2B,MAAK,GAAI,gBAAgB,GAAC,GAAE,GAAI,IAAI,CAAC3F,WAAW,CAAC4B,CAAC,CAAC,CAACwD,KAAK,GAAC,GAAG;QACtF,IAAI,CAACnF,UAAU,CAAC2B,CAAC,CAAC,CAACoC,KAAK,CAAC4B,OAAM,GAAI,IAAI,CAAC5F,WAAW,CAAC4B,CAAC,CAAC,CAACwD,KAAK;MAC9D;IACF,CAAC;IACDE,SAAS,GAAE;MACT,IAAInC,IAAG,GAAI,EAAE;MACb,KAAK,IAAIvB,IAAI,CAAC,EAAEA,IAAI,IAAI,CAAC3B,UAAU,CAAC4B,MAAM,EAAED,CAAC,EAAE,EAAE;QAC/CuB,IAAI,CAACnB,IAAI,CAAC,IAAI,CAAC/B,UAAU,CAAC2B,CAAC,CAAC,CAAC;MAC/B;MACAuB,IAAI,CAACG,IAAI,CAAC,CAACuC,KAAK,EAAEC,KAAK,KAAKA,KAAK,CAAC/B,EAAC,GAAI8B,KAAK,CAAC9B,EAAE,CAAC;MAChD,KAAK,IAAInC,IAAI,CAAC,EAAEA,IAAIuB,IAAI,CAACtB,MAAM,EAAED,CAAC,EAAE,EAAE;QACpCuB,IAAI,CAACvB,CAAC,CAAC,CAACoC,KAAK,CAAC+B,MAAM,GAACnE,CAAC;MACxB;IACF,CAAC;IACDK,UAAS,CAAG+D,CAAC,EAAEC,CAAC,EAAEC,CAAC,EAAE;MACnB,IAAI,CAAC/F,IAAG,GAAIZ,IAAI,CAACsE,GAAG,CAACmC,IAAI,IAAI,CAAC1G,GAAG,CAAC;MAClC,IAAI,CAACc,IAAG,GAAIb,IAAI,CAACqE,GAAG,CAACoC,IAAI,IAAI,CAAC1G,GAAG,CAAC;MAClC,IAAI,CAACe,IAAG,GAAId,IAAI,CAACsE,GAAG,CAACoC,IAAI,IAAI,CAAC3G,GAAG,CAAC;MAClC,IAAI,CAACgB,IAAG,GAAIf,IAAI,CAACqE,GAAG,CAACqC,IAAI,IAAI,CAAC3G,GAAG,CAAC;MAClC,IAAI,CAACiB,IAAG,GAAIhB,IAAI,CAACsE,GAAG,CAACqC,IAAI,IAAI,CAAC5G,GAAG,CAAC;MAClC,IAAI,CAACkB,IAAG,GAAIjB,IAAI,CAACqE,GAAG,CAACsC,IAAI,IAAI,CAAC5G,GAAG,CAAC;IACpC;EACF;AACF,CAAC","names":["mapGetters","name","computed","data","timer","radius","dtr","Math","PI","active","lasta","lastb","distr","tspeed","mouseX","mouseY","tagAttrList","tagContent","cloudContent","sinA","cosA","sinB","cosB","sinC","cosC","dataList","getIssueKeyword","value","bgColor","color","mounted","$nextTick","document","querySelector","offsetWidth","initWordCloud","beforeDestroy","clearInterval","methods","getDataInfo","item","console","log","getElementsByTagName","i","length","tagObj","offsetHeight","push","sineCosine","positionAll","onmouseover","onmouseout","onmousemove","ev","oEvent","window","event","clientX","offsetLeft","clientY","offsetTop","setInterval","update","phi","theta","max","aTmp","oFragment","createDocumentFragment","sort","random","appendChild","acos","sqrt","cx","cos","sin","cy","cz","style","left","top","angleBasicA","angleBasicB","min","j","rx1","ry1","rz1","rx2","ry2","rz2","rx3","ry3","rz3","per","x","y","scale","alpha","doPosition","depthSort","len","height","fontSize","ceil","filter","opacity","item1","item2","zIndex","a","b","c"],"sourceRoot":"","sources":["/Users/tangxinyu/WebstormProjects/cs209a_proj/src/components/WordCloudGraph.vue"],"sourcesContent":["<template>\n  <section class=\"cloud-bed\">\n    <div class=\"cloud-box\">\n      <span\n          v-for=\"(item, index) in dataList\"\n          :key=\"index\"\n          @click=\"getDataInfo(item)\"\n          :style=\"{color:item.color,background:item.bgColor}\"\n      >\n        {{ item.name }}\n      </span>\n    </div>\n  </section>\n</template>\n\n<script>\nimport {mapGetters} from \"vuex\";\nexport default {\n  name: \"word-cloud\",\n  computed:{\n    ...mapGetters([\"getIssueKeyword\"]),\n  },\n  data() {\n    return {\n      timer: 50, // 球体转动速率\n      radius: 0, // 词云球体面积大小\n      dtr: Math.PI/180, //鼠标滑过球体转动速度\n      active: false, // 默认加载是否开启转动\n      lasta: 0, // 上下转动\n      lastb: 0.5, // 左右转动\n      distr: true,\n      tspeed: 0, // 鼠标移动上去时球体转动\n      mouseX: 0,\n      mouseY: 0,\n      tagAttrList: [],\n      tagContent: null,\n      cloudContent: null,\n      sinA: '',\n      cosA: '',\n      sinB: '',\n      cosB: '',\n      sinC: '',\n      cosC: '',\n      dataList: [\n        {\n          name: this.getIssueKeyword[0],\n          value: '1',\n          bgColor:'rgb(57, 193, 207,0.12)',\n          color:'#39c1cf',\n        },\n        {\n          name: '闪退',\n          value: '8',\n          bgColor:'rgb(66, 105, 245,0.12)',\n          color:'#4269f5',\n        },\n        {\n          name: '登录问题',\n          value: '9',\n          bgColor:'rgb(184, 107, 215,0.12)',\n          color:'#b86bd7',\n        },\n        {\n          name: '功能bug',\n          value: '3',\n          bgColor:'rgb(243, 84, 83,0.12)',\n          color:'#f35453',\n        },\n        {\n          name: '无法收到短信',\n          value: '6',\n          bgColor:'rgb(250, 116, 20,0.12)',\n          color:'#FA7414',\n        },\n        {\n          name: '人脸/指纹认证失败',\n          value: '10',\n          bgColor:'rgb(255, 171, 30,0.12)',\n          color:'#FFAB1E',\n        },\n        {\n          name: '功能建议',\n          value: '2',\n          bgColor:'rgb(136, 104, 217,0.12)',\n          color:'#8868D9',\n        },\n        {\n          name: 'UI/UX',\n          value: '5',\n          bgColor:'rgb(42, 184, 230,0.12)',\n          color:'#2AB8E6',\n        },\n        {\n          name: '导航性',\n          value: '7',\n          bgColor:'rgb(117, 133, 162,0.12)',\n          color:'#7585A2',\n        },\n      ]\n    }\n  },\n  mounted () {\n    this.$nextTick(() => {\n      this.radius = document.querySelector('.cloud-box').offsetWidth / 2\n      this.initWordCloud()\n    })\n  },\n  beforeDestroy () {\n    clearInterval(this.timer)\n  },\n  methods:{\n    // 获取点击文本信息\n    getDataInfo (item) {\n      console.log(item, 'item')\n    },\n    initWordCloud () {\n      this.cloudContent = document.querySelector('.cloud-box');\n      this.tagContent = this.cloudContent.getElementsByTagName('span');\n      for (let i = 0; i < this.tagContent.length; i++) {\n        let tagObj = {};\n        tagObj.offsetWidth = this.tagContent[i].offsetWidth;\n        tagObj.offsetHeight = this.tagContent[i].offsetHeight;\n        this.tagAttrList.push(tagObj);\n      }\n      this.sineCosine(0, 0, 0);\n      this.positionAll();\n      this.cloudContent.onmouseover = () => {\n        this.active=true;\n      };\n      this.cloudContent.onmouseout = () => {\n        this.active=false;\n      };\n      this.cloudContent.onmousemove = (ev) => {\n        let oEvent = window.event || ev;\n        this.mouseX = oEvent.clientX - (this.cloudContent.offsetLeft + this.cloudContent.offsetWidth/2);\n        this.mouseY = oEvent.clientY - (this.cloudContent.offsetTop + this.cloudContent.offsetHeight/2);\n        this.mouseX/= 5;\n        this.mouseY/= 5;\n      };\n      setInterval(this.update, this.timer);\n    },\n    positionAll () {\n      let phi = 0;\n      let theta = 0;\n      let max = this.tagAttrList.length;\n      let aTmp = [];\n      let oFragment = document.createDocumentFragment();\n      //随机排序\n      for (let i=0; i < this.tagContent.length; i++) {\n        aTmp.push(this.tagContent[i]);\n      }\n      aTmp.sort(() => {\n        return Math.random() < 0.5 ? 1 : -1;\n      });\n      for (let i = 0; i < aTmp.length; i++) {\n        oFragment.appendChild(aTmp[i]);\n      }\n      this.cloudContent.appendChild(oFragment);\n      for(let i = 1; i < max + 1; i++){\n        if (this.distr) {\n          phi = Math.acos(-1 + (2 * i - 1) / max);\n          theta = Math.sqrt(max * Math.PI) * phi;\n        } else {\n          phi = Math.random() * (Math.PI);\n          theta = Math.random() * (2 * Math.PI);\n        }\n        //坐标变换\n        this.tagAttrList[i-1].cx = this.radius * Math.cos(theta) * Math.sin(phi);\n        this.tagAttrList[i-1].cy = this.radius * Math.sin(theta) * Math.sin(phi);\n        this.tagAttrList[i-1].cz = this.radius * Math.cos(phi);\n        this.tagContent[i-1].style.left = this.tagAttrList[i-1].cx + this.cloudContent.offsetWidth / 2 - this.tagAttrList[i-1].offsetWidth / 2 + 'px';\n        this.tagContent[i-1].style.top = this.tagAttrList[i-1].cy + this.cloudContent.offsetHeight / 2 - this.tagAttrList[i-1].offsetHeight / 2 + 'px';\n      }\n    },\n    update () {\n      let angleBasicA;\n      let angleBasicB;\n\n      if (this.active) {\n        angleBasicA = (-Math.min(Math.max(-this.mouseY, -200 ), 200) / this.radius) * this.tspeed;\n        angleBasicB = (Math.min(Math.max(-this.mouseX, -200 ), 200) / this.radius) * this.tspeed;\n      } else {\n        angleBasicA = this.lasta * 0.98;\n        angleBasicB = this.lastb * 0.98;\n      }\n\n      //默认转动是后是否需要停下\n      // lasta=a;\n      // lastb=b;\n\n      // if(Math.abs(a)<=0.01 && Math.abs(b)<=0.01)\n      // {\n      // return;\n      // }\n      this.sineCosine(angleBasicA, angleBasicB, 0);\n      for(let j = 0; j < this.tagAttrList.length; j++) {\n        let rx1 = this.tagAttrList[j].cx;\n        let ry1 = this.tagAttrList[j].cy * this.cosA + this.tagAttrList[j].cz * (-this.sinA);\n        let rz1 = this.tagAttrList[j].cy * this.sinA + this.tagAttrList[j].cz * this.cosA;\n\n        let rx2 = rx1 * this.cosB + rz1 * this.sinB;\n        let ry2 = ry1;\n        let rz2 = rx1 * (-this.sinB) + rz1 * this.cosB;\n\n        let rx3 = rx2 * this.cosC + ry2 * (-this.sinC);\n        let ry3 = rx2 * this.sinC + ry2 * this.cosC;\n        let rz3 = rz2;\n        this.tagAttrList[j].cx = rx3;\n        this.tagAttrList[j].cy = ry3;\n        this.tagAttrList[j].cz = rz3;\n\n        let per = 350 / (350 + rz3);\n\n        this.tagAttrList[j].x = rx3 * per - 2;\n        this.tagAttrList[j].y = ry3 * per;\n        this.tagAttrList[j].scale = per;\n        this.tagAttrList[j].alpha = per;\n\n        this.tagAttrList[j].alpha = (this.tagAttrList[j].alpha - 0.6) * (10/6);\n      }\n      this.doPosition();\n      this.depthSort();\n    },\n    doPosition() {\n      let len = this.cloudContent.offsetWidth/2;\n      let height = this.cloudContent.offsetHeight/2;\n      for (let i=0;i < this.tagAttrList.length;i++) {\n        this.tagContent[i].style.left = this.tagAttrList[i].cx + len - this.tagAttrList[i].offsetWidth/2 + 'px';\n        this.tagContent[i].style.top = this.tagAttrList[i].cy + height - this.tagAttrList[i].offsetHeight/2 + 'px';\n        // this.tagContent[i].style.fontSize = Math.ceil(12 * this.tagAttrList[i].scale/2) + 8 + 'px';\n        this.tagContent[i].style.fontSize = Math.ceil(12 * this.tagAttrList[i].scale/2) +2 + 'px';\n        this.tagContent[i].style.filter = \"alpha(opacity=\"+100 * this.tagAttrList[i].alpha+\")\";\n        this.tagContent[i].style.opacity = this.tagAttrList[i].alpha;\n      }\n    },\n    depthSort(){\n      let aTmp = [];\n      for (let i = 0; i < this.tagContent.length; i++) {\n        aTmp.push(this.tagContent[i]);\n      }\n      aTmp.sort((item1, item2) => item2.cz - item1.cz);\n      for (let i = 0; i < aTmp.length; i++) {\n        aTmp[i].style.zIndex=i;\n      }\n    },\n    sineCosine (a, b, c) {\n      this.sinA = Math.sin(a * this.dtr);\n      this.cosA = Math.cos(a * this.dtr);\n      this.sinB = Math.sin(b * this.dtr);\n      this.cosB = Math.cos(b * this.dtr);\n      this.sinC = Math.sin(c * this.dtr);\n      this.cosC = Math.cos(c * this.dtr);\n    }\n  }\n};\n</script>\n\n\n<style scoped>\n.cloud-bed {\n  width: 200px;\n  height: 200px;\n  margin: auto;\n}\n.cloud-box{\n  position:relative;\n  margin:20px auto 0px;\n  width: 100%;\n  height: 100%;\n  background:\t#00000000;\n}\n.cloud-box span{\n  position: absolute;\n  padding: 3px 6px;\n  top: 0px;\n  font-weight: bold;\n  text-decoration:none;\n  left:0px;\n  background-image: linear-gradient(to bottom, red, #fff);\n  /*background-clip: text;*/\n  color: transparent;\n  width: 50px;\n  height: 50px;\n  border-radius: 50%;\n  text-align: center;\n\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  /* line-height: 50px;\n  overflow:hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis; */\n}\n</style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}