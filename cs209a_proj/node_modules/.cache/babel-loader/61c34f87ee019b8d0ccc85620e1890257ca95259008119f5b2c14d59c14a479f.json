{"ast":null,"code":"/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar _util = require(\"zrender/lib/core/util\");\nvar each = _util.each;\nvar parseGeoJson = require(\"./parseGeoJson\");\nvar _model = require(\"../../util/model\");\nvar makeInner = _model.makeInner;\nvar fixNanhai = require(\"./fix/nanhai\");\nvar fixTextCoord = require(\"./fix/textCoord\");\nvar fixGeoCoord = require(\"./fix/geoCoord\");\nvar fixDiaoyuIsland = require(\"./fix/diaoyuIsland\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n// Built-in GEO fixer.\nvar inner = makeInner();\nvar _default = {\n  /**\n   * @param {string} mapName\n   * @param {Object} mapRecord {specialAreas, geoJSON}\n   * @return {Object} {regions, boundingRect}\n   */\n  load: function (mapName, mapRecord) {\n    var parsed = inner(mapRecord).parsed;\n    if (parsed) {\n      return parsed;\n    }\n    var specialAreas = mapRecord.specialAreas || {};\n    var geoJSON = mapRecord.geoJSON;\n    var regions; // https://jsperf.com/try-catch-performance-overhead\n\n    try {\n      regions = geoJSON ? parseGeoJson(geoJSON) : [];\n    } catch (e) {\n      throw new Error('Invalid geoJson format\\n' + e.message);\n    }\n    fixNanhai(mapName, regions);\n    each(regions, function (region) {\n      var regionName = region.name;\n      fixTextCoord(mapName, region);\n      fixGeoCoord(mapName, region);\n      fixDiaoyuIsland(mapName, region); // Some area like Alaska in USA map needs to be tansformed\n      // to look better\n\n      var specialArea = specialAreas[regionName];\n      if (specialArea) {\n        region.transformTo(specialArea.left, specialArea.top, specialArea.width, specialArea.height);\n      }\n    });\n    return inner(mapRecord).parsed = {\n      regions: regions,\n      boundingRect: getBoundingRect(regions)\n    };\n  }\n};\nfunction getBoundingRect(regions) {\n  var rect;\n  for (var i = 0; i < regions.length; i++) {\n    var regionRect = regions[i].getBoundingRect();\n    rect = rect || regionRect.clone();\n    rect.union(regionRect);\n  }\n  return rect;\n}\nmodule.exports = _default;","map":{"version":3,"names":["_util","require","each","parseGeoJson","_model","makeInner","fixNanhai","fixTextCoord","fixGeoCoord","fixDiaoyuIsland","inner","_default","load","mapName","mapRecord","parsed","specialAreas","geoJSON","regions","e","Error","message","region","regionName","name","specialArea","transformTo","left","top","width","height","boundingRect","getBoundingRect","rect","i","length","regionRect","clone","union","module","exports"],"sources":["/Users/tangxinyu/WebstormProjects/cs209a_proj/node_modules/echarts/lib/coord/geo/geoJSONLoader.js"],"sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar _util = require(\"zrender/lib/core/util\");\n\nvar each = _util.each;\n\nvar parseGeoJson = require(\"./parseGeoJson\");\n\nvar _model = require(\"../../util/model\");\n\nvar makeInner = _model.makeInner;\n\nvar fixNanhai = require(\"./fix/nanhai\");\n\nvar fixTextCoord = require(\"./fix/textCoord\");\n\nvar fixGeoCoord = require(\"./fix/geoCoord\");\n\nvar fixDiaoyuIsland = require(\"./fix/diaoyuIsland\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n// Built-in GEO fixer.\nvar inner = makeInner();\nvar _default = {\n  /**\n   * @param {string} mapName\n   * @param {Object} mapRecord {specialAreas, geoJSON}\n   * @return {Object} {regions, boundingRect}\n   */\n  load: function (mapName, mapRecord) {\n    var parsed = inner(mapRecord).parsed;\n\n    if (parsed) {\n      return parsed;\n    }\n\n    var specialAreas = mapRecord.specialAreas || {};\n    var geoJSON = mapRecord.geoJSON;\n    var regions; // https://jsperf.com/try-catch-performance-overhead\n\n    try {\n      regions = geoJSON ? parseGeoJson(geoJSON) : [];\n    } catch (e) {\n      throw new Error('Invalid geoJson format\\n' + e.message);\n    }\n\n    fixNanhai(mapName, regions);\n    each(regions, function (region) {\n      var regionName = region.name;\n      fixTextCoord(mapName, region);\n      fixGeoCoord(mapName, region);\n      fixDiaoyuIsland(mapName, region); // Some area like Alaska in USA map needs to be tansformed\n      // to look better\n\n      var specialArea = specialAreas[regionName];\n\n      if (specialArea) {\n        region.transformTo(specialArea.left, specialArea.top, specialArea.width, specialArea.height);\n      }\n    });\n    return inner(mapRecord).parsed = {\n      regions: regions,\n      boundingRect: getBoundingRect(regions)\n    };\n  }\n};\n\nfunction getBoundingRect(regions) {\n  var rect;\n\n  for (var i = 0; i < regions.length; i++) {\n    var regionRect = regions[i].getBoundingRect();\n    rect = rect || regionRect.clone();\n    rect.union(regionRect);\n  }\n\n  return rect;\n}\n\nmodule.exports = _default;"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}